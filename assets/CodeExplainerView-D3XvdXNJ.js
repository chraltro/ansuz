import{j as e,r as o,M as n,a as r}from"./markdown-vendor-VnR7y5Ko.js";import{S as t}from"./index-BqnNp4TT.js";import{h as s}from"./syntax-highlighter-Cp37pCpN.js";import"./react-vendor-RsqJS7wA.js";const l={'code[class*="language-"]':{color:"#c5c8c6",textShadow:"0 1px rgba(0, 0, 0, 0.3)",fontFamily:"Inconsolata, Monaco, Consolas, 'Courier New', Courier, monospace",direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",lineHeight:"1.5",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none"},'pre[class*="language-"]':{color:"#c5c8c6",textShadow:"0 1px rgba(0, 0, 0, 0.3)",fontFamily:"Inconsolata, Monaco, Consolas, 'Courier New', Courier, monospace",direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",lineHeight:"1.5",MozTabSize:"4",OTabSize:"4",tabSize:"4",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none",padding:"1em",margin:".5em 0",overflow:"auto",borderRadius:"0.3em",background:"#1d1f21"},':not(pre) > code[class*="language-"]':{background:"#1d1f21",padding:".1em",borderRadius:".3em"},comment:{color:"#7C7C7C"},prolog:{color:"#7C7C7C"},doctype:{color:"#7C7C7C"},cdata:{color:"#7C7C7C"},punctuation:{color:"#c5c8c6"},".namespace":{Opacity:".7"},property:{color:"#96CBFE"},keyword:{color:"#96CBFE"},tag:{color:"#96CBFE"},"class-name":{color:"#FFFFB6",textDecoration:"underline"},boolean:{color:"#99CC99"},constant:{color:"#99CC99"},symbol:{color:"#f92672"},deleted:{color:"#f92672"},number:{color:"#FF73FD"},selector:{color:"#A8FF60"},"attr-name":{color:"#A8FF60"},string:{color:"#A8FF60"},char:{color:"#A8FF60"},builtin:{color:"#A8FF60"},inserted:{color:"#A8FF60"},variable:{color:"#C6C5FE"},operator:{color:"#EDEDED"},entity:{color:"#FFFFB6",cursor:"help"},url:{color:"#96CBFE"},".language-css .token.string":{color:"#87C38A"},".style .token.string":{color:"#87C38A"},atrule:{color:"#F9EE98"},"attr-value":{color:"#F9EE98"},function:{color:"#DAD085"},regex:{color:"#E9C062"},important:{color:"#fd971f",fontWeight:"bold"},bold:{fontWeight:"bold"},italic:{fontStyle:"italic"}},a=({className:o="w-5 h-5"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:o,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.553L16.5 21.75l-.398-1.197a3.375 3.375 0 00-2.456-2.456L12.5 18l1.197-.398a3.375 3.375 0 002.456-2.456L16.5 14.25l.398 1.197a3.375 3.375 0 002.456 2.456L20.5 18l-1.197.398a3.375 3.375 0 00-2.456 2.456z"})}),c=({explanation:c,isLoading:i,fileName:d,code:p,onDeepDive:u,deepDiveStatus:m})=>{const[g,h]=o.useState(null),[x,b]=o.useState(null),f=o.useRef(null),y=o.useRef(null),j=o.useRef([]),w=o.useRef([]);o.useEffect(()=>{const e=c?.blocks.length??0;j.current=j.current.slice(0,e)},[c]);const v={behavior:"smooth",block:"center",inline:"nearest"},k=o.useMemo(()=>{const e=new Map;if(!c||!p)return e;let o=0;return c.blocks.forEach((n,r)=>{const t=n.code_block;if(!t)return;const s=((e,o,n)=>{if(!o)return null;let r=e.indexOf(o,n);if(-1!==r)return{index:r,content:o};const t=o.replace(/\n/g,"\r\n");if(t!==o&&(r=e.indexOf(t,n),-1!==r))return{index:r,content:t};const s=e=>e.trim().replace(/\s+/g," "),l=s(o),a=e.substring(n).split("\n");let c=n;for(let i=0;i<a.length;i++){for(let e=1;e<=Math.min(5,a.length-i);e++){const o=a.slice(i,i+e).join("\n");if(s(o)===l){const e=a.slice(0,i).join("\n");return{index:n+(i>0?e.length+1:0),content:o}}}c+=a[i].length+1}return null})(p,t,o);if(!s)return;const{index:l,content:a}=s,c=(p.substring(0,l).match(/\n/g)||[]).length+1,i=c+(a.match(/\n/g)||[]).length;for(let o=c;o<=i;o++)e.set(o,{blockIndex:r});o=l+a.length}),e},[p,c]),C=o.useMemo(()=>{const e=new Map;if(!k)return e;const o=new Set;for(const[n,r]of k.entries())o.has(r.blockIndex)||(e.set(r.blockIndex,n),o.add(r.blockIndex));return e},[k]),F=o.useMemo(()=>c?.blocks.map((e,o)=>({...e,blockIndex:o}))??[],[c]);o.useEffect(()=>{"left"===x&&null!==g&&f.current&&j.current[g]?.scrollIntoView(v)},[g,x]),o.useEffect(()=>{if("right"===x&&null!==g){const e=C.get(g);e&&w.current[e]?.scrollIntoView(v)}},[g,x,C]);const N=o.useMemo(()=>p.split("\n"),[p]),L=(e=>{const o=e.split(".").pop()?.toLowerCase();switch(o){case"js":case"jsx":return"javascript";case"ts":case"tsx":return"typescript";case"py":return"python";case"java":return"java";case"html":return"html";case"css":return"css";case"json":return"json";case"md":return"markdown";case"yml":case"yaml":return"yaml";default:return"clike"}})(d),E=i&&(!c||0===c.blocks.length),M={...l,'pre[class*="language-"]':{...l['pre[class*="language-"]']||{},background:"transparent",margin:0,padding:"1em 0",whiteSpace:"pre",overflowX:"auto"},'code[class*="language-"]':{...l['code[class*="language-"]']||{},fontFamily:"'Fira Code', monospace",fontSize:"14px",whiteSpace:"pre"}};return e.jsxs("div",{className:"grid grid-cols-2 h-full font-mono",children:[e.jsx("div",{className:"col-span-1 h-full overflow-auto bg-gray-900",children:e.jsx(s,{language:L,style:M,showLineNumbers:!0,wrapLines:!0,lineProps:e=>{const o=k.get(e),n={display:"block",width:"100%",transition:"background-color 0.2s"},r=N[e-1]?.trim();if(!o)return""!==r&&(n.opacity=.5),{style:n};const t=o.blockIndex;return g===t&&(n.backgroundColor="rgba(65, 72, 104, 0.5)"),{ref:o=>{o&&(w.current[e]=o)},style:n,onMouseEnter:()=>{b("left"),h(t)},onMouseLeave:()=>{b(null),h(null)}}},PreTag:"div",children:p})}),e.jsx("div",{ref:f,className:"col-span-1 h-full overflow-y-auto bg-gray-800 border-l border-gray-700",children:e.jsxs("div",{className:"p-6 space-y-2 font-sans",children:[e.jsxs("div",{className:"pb-4 mb-4 border-b border-gray-700",children:[e.jsx("h2",{className:"text-xl font-bold text-blue-light",children:"Code Explanations"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Hover over code on the left or an explanation below."})]}),E&&e.jsxs("div",{className:"col-span-1 h-full flex flex-col items-center justify-center text-gray-500",children:[e.jsx(t,{className:"w-12 h-12 text-blue-accent"}),e.jsxs("p",{className:"mt-4 text-lg font-sans",children:["Analyzing ",d,"..."]}),e.jsx("p",{className:"text-sm font-sans",children:"Explanations will appear here as they're generated."})]}),F.map(o=>{const s=o.blockIndex,l=m.isLoading&&m.blockIndex===s,c=o.explanation||"";return e.jsxs("div",{ref:e=>{"number"==typeof s&&(j.current[s]=e)},onMouseEnter:()=>{b("right"),h(s)},onMouseLeave:()=>{b(null),h(null)},className:"group p-4 rounded-lg transition-all duration-300 border "+(g===s?"bg-gray-700/50 border-blue-accent/50":"bg-transparent border-transparent"),children:[e.jsx("div",{className:"prose prose-invert max-w-none prose-sm prose-p:text-blue-light prose-p:mb-6 prose-headings:text-cyan-accent prose-strong:text-orange-accent prose-code:text-orange-accent prose-code:before:content-[''] prose-code:after:content-[''] prose-li:text-blue-light prose-li:my-3 prose-ul:my-6 prose-ol:my-6",children:e.jsx(n,{remarkPlugins:[r],children:c.trim()})}),e.jsx("div",{className:"mt-3",children:o.deep_dive_explanation?e.jsxs("div",{className:"mt-4 p-4 border-l-2 border-cyan-accent/50 bg-gray-900/30 rounded-r-lg",children:[e.jsxs("h4",{className:"font-bold text-sm text-cyan-accent flex items-center mb-2",children:[e.jsx(a,{className:"w-4 h-4 mr-2"}),"Deep Dive"]}),e.jsxs("div",{className:"prose prose-invert max-w-none prose-sm prose-p:text-blue-light/90 prose-p:mb-6 prose-strong:text-orange-accent prose-li:text-blue-light prose-li:my-3 prose-ul:my-6 prose-ol:my-6",children:[e.jsx(n,{remarkPlugins:[r],children:o.deep_dive_explanation}),l&&e.jsx("span",{className:"inline-block w-2 h-4 bg-blue-light animate-pulse ml-1"})]})]}):c.trim()&&e.jsxs("button",{onClick:()=>u(s),disabled:m.isLoading,className:"flex items-center space-x-2 text-sm text-cyan-accent hover:text-white disabled:text-gray-600 disabled:cursor-not-allowed font-semibold py-1 px-2 rounded-md bg-gray-700/50 hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-all duration-300",children:[l?e.jsx(t,{className:"w-4 h-4"}):e.jsx(a,{className:"w-4 h-4"}),e.jsx("span",{children:l?"Analyzing...":"Deep Dive"})]})})]},`expl-${s}`)}),i&&!E&&e.jsxs("div",{ref:y,className:"flex items-center p-4 text-gray-500",children:[e.jsx(t,{className:"w-5 h-5 mr-3"}),e.jsx("span",{children:"Generating explanation..."})]}),!i&&0===c?.blocks.length&&!E&&e.jsx("div",{className:"flex items-center justify-center h-full text-gray-600 p-8 text-center",children:e.jsx("p",{children:"No explanation available. The file might be empty, unsupported, or an error occurred."})})]})})]})};export{c as default};
